{"ast":null,"code":"import Modal from \"@/components/Modal\";\nimport { CheckIcon, SelectorIcon } from \"@heroicons/vue/solid\";\nimport { Listbox, ListboxButton, ListboxOptions, ListboxOption } from \"@headlessui/vue\";\nimport { Icon } from \"@iconify/vue\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\nexport default {\n  name: \"Fonctions\",\n  components: {\n    Modal,\n    Listbox,\n    ListboxButton,\n    ListboxOptions,\n    ListboxOption,\n    CheckIcon,\n    SelectorIcon,\n    Icon\n  },\n  methods: {\n    capitalize(str) {\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n\n    openCreateModal() {\n      this.$refs.createModal.open = true;\n    },\n\n    opendeletemodal(fonction) {\n      this.$refs.obj = fonction;\n      this.$refs.deletedModal.open = true;\n    },\n\n    // eslint-disable-next-line no-unused-vars\n    updateAutorisation(aut, type) {\n      if (this.selectedFonction.Autorisations.find(el => el.id === aut.id)) {\n        this.selectedFonction.Autorisations = this.selectedFonction.Autorisations.filter(autorisation => autorisation.id != aut.id);\n      } else {\n        // aut.autorisations_fonctions?.type = type || 'all';\n        this.selectedFonction.Autorisations.push({\n          autorisations_fonctions: {\n            type: type || \"all\"\n          },\n          ...aut\n        });\n      }\n\n      this.selectedFonction.updated = false;\n    },\n\n    async updateFonction() {\n      if (this.selectedFonction.updated) return;\n\n      try {\n        this.$store.dispatch(\"updateFonction\", this.selectedFonction).then(res => {\n          console.log(res);\n          this.selectedFonction.updated = true;\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async saveFonction() {\n      try {\n        await this.$store.dispatch(\"addFonction\", this.newFonction);\n        this.$refs.createModal.open = false;\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async deleteFonction(f) {\n      console.log(f);\n\n      try {\n        await this.$store.dispatch(\"deleteFonction\", f.id || this.selectedFonction.id); // this.$refs.deletedModal.open = false;\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    changedColor(color) {\n      this.newFonction.couleur = color;\n    }\n\n  },\n\n  async beforeMount() {\n    await this.$store.dispatch(\"getFonctions\");\n    await this.$store.dispatch(\"getAutorisations\"); // console.log(\"hey\",)\n\n    this.selectedFonction = this.fonctions[this.fonctions.map(el => el.id).indexOf(this.$store.state.users.user.Profile.id)];\n  },\n\n  data() {\n    return {\n      selectedFonction: null,\n      newFonction: {},\n      deletedFonction: {},\n      icons: [],\n      isMobile: false,\n      showColorPicker: false\n    };\n  },\n\n  computed: {\n    autorisations() {\n      return this.$store.state.fonctions.autorisations;\n    },\n\n    categories() {\n      return this.$store.state.fonctions.autorisations.map(autorisation => autorisation.categorie).filter((categorie, index, self) => self.indexOf(categorie) === index);\n    },\n\n    fonctions() {\n      return this.$store.state.fonctions.fonctions;\n    }\n\n  },\n  watch: {\n    \"newFonction.icon\": _.debounce(async function () {\n      this.icons = (await axios.get(`https://api.iconify.design/search?query=${this.newFonction.icon}`)).data.icons;\n    }, 200),\n\n    selectedFonction() {\n      // this.$store.dispatch('getFonctions')\n      if (this.selectedFonction.updated === undefined) this.selectedFonction.updated = true;\n    },\n\n    \"fonctions\": function () {\n      if (!this.fonctions.find(el => el.id == this.selectedFonction)) {\n        this.selectedFonction = this.fonctions.find(el => el.id == this.$store.state.users.user.Profile.id);\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:\\Users\\Dell\\Desktop\\vost-app\\src\\views\\user\\Fonction.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"flex flex-col h-screen w-full overflow-hidden\">\r\n\t\t<div class=\"mx-2 mt-3 w-full flex flex-row\">\r\n\t\t\t<Listbox v-model=\"selectedFonction\">\r\n\t\t\t\t<ListboxButton\r\n\t\t\t\t\tclass=\"relative w-44 py-2 pl-3 pr-10 text-left bg-white rounded-lg shadow-md cursor-default focus:outline-none focus-visible:ring-2 focus-visible:ring-opacity-75 focus-visible:ring-white focus-visible:ring-offset-orange-300 focus-visible:ring-offset-2 focus-visible:border-indigo-500 sm:text-sm\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"block truncate text-gray-700 font-semibold text-center\"\r\n\t\t\t\t\t\t>{{ selectedFonction && selectedFonction.nom }}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclass=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SelectorIcon class=\"w-5 h-5 text-gray-400\" aria-hidden=\"true\" />\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</ListboxButton>\r\n\r\n\t\t\t\t<transition\r\n\t\t\t\t\tleave-active-class=\"transition duration-100 ease-in\"\r\n\t\t\t\t\tleave-from-class=\"opacity-100\"\r\n\t\t\t\t\tleave-to-class=\"opacity-0\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ListboxOptions\r\n\t\t\t\t\t\tclass=\"absolute w-44 py-1 mt-10 overflow-auto text-base bg-white rounded-md shadow-lg max-h-60 ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ListboxOption\r\n\t\t\t\t\t\t\tv-slot=\"{ active, selected }\"\r\n\t\t\t\t\t\t\tv-for=\"fonction in fonctions\"\r\n\t\t\t\t\t\t\t:key=\"fonction.id\"\r\n\t\t\t\t\t\t\t:value=\"fonction\"\r\n\t\t\t\t\t\t\tas=\"template\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\tactive ? 'text-gray-900 bg-gray-100' : 'text-gray-500',\r\n\t\t\t\t\t\t\t\t\tselected ? 'bg-indigo-100' : 'bg-white',\r\n\t\t\t\t\t\t\t\t\t'cursor-default select-none group  relative py-2 px-2 pr-4 text-left inline-flex w-full justify-between items-center transition-all duration-100',\r\n\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\t\tselected ? 'font-semibold' : 'font-normal',\r\n\t\t\t\t\t\t\t\t\t\t'block truncate',\r\n\t\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t\t\t>{{ fonction.nom }}</span\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div class=\"p-1\" @click=\"deleteFonction(fonction)\">\r\n\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\ticon=\"bi:archive\"\r\n\t\t\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\t\t\t'w-5 h-5 ml-2 hidden text-red-500 md:hover:text-red-500 md:group-hover:block',\r\n\t\t\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tv-if=\"selected\"\r\n\t\t\t\t\t\t\t\t\tclass=\"flex items-center pl-3 text-amber-600\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<CheckIcon class=\"w-5 h-5\" aria-hidden=\"true\" />\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t</ListboxOption>\r\n\t\t\t\t\t</ListboxOptions>\r\n\t\t\t\t</transition>\r\n\t\t\t</Listbox>\r\n\t\t\t<button\r\n\t\t\t\t@click=\"openCreateModal\"\r\n\t\t\t\tclass=\"ml-2 items-center border-2 border-green-300 rounded-md px-3 bg-gray-200 hover:bg-gray-400 hover:text-white py-2 inline-flex\"\r\n\t\t\t>\r\n\t\t\t\t<Icon icon=\"carbon:bookmark-add\" class=\"w-5 h-5\" />\r\n\t\t\t\t<span class=\"ml-1\">Ajouter</span>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class=\"bg-white shadow-lg rounded-md flex-1 m-2 p-1 overflow-y-auto\">\r\n\t\t\t<!-- <h1 class=\"font-semibold text-md\">Autorisations</h1> -->\r\n\t\t\t<div class=\"w-full grid grid-rows-7 ml-1 md:ml-0\">\r\n\t\t\t\t<div class=\"md:grid grid-cols-3 hidden\">\r\n\t\t\t\t\t<div class=\"font-bold w-full text-center border\">Gestion</div>\r\n\t\t\t\t\t<div class=\"grid grid-cols-4 col-span-2\">\r\n\t\t\t\t\t\t<div class=\"font-bold w-full text-gray-600 text-center border\">\r\n\t\t\t\t\t\t\tLister\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"font-bold w-full text-gray-600 text-center border\">\r\n\t\t\t\t\t\t\tAjouter\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"font-bold w-full text-gray-600 text-center border\">\r\n\t\t\t\t\t\t\tArchiver\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"font-bold w-full text-gray-600 text-center border\">\r\n\t\t\t\t\t\t\tModifier\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"grid md:grid-cols-3 space-y-2 md:space-y-0\"\r\n\t\t\t\t\tv-for=\"c in categories\"\r\n\t\t\t\t\t:key=\"c\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"md:border md:items-center md:justify-center md:inline-flex\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{{ capitalize(c) }}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"grid md:grid-cols-4 md:grid-flow-col col-span-2\">\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t'flex flex-col md:justify-center md:border',\r\n\t\t\t\t\t\t\t\t(a.nom.startsWith('add') && 'order-2 ') ||\r\n\t\t\t\t\t\t\t\t\t(a.nom.startsWith('delete') && 'order-3') ||\r\n\t\t\t\t\t\t\t\t\t(a.nom.startsWith('update') && 'order-4') ||\r\n\t\t\t\t\t\t\t\t\t(a.nom.startsWith('read') && 'order-1'),\r\n\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\tv-for=\"a in autorisations\r\n\t\t\t\t\t\t\t\t.filter((el) => el.categorie === c)\r\n\t\t\t\t\t\t\t\t.sort((el) => el.id)\"\r\n\t\t\t\t\t\t\t:key=\"a\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\"inline-flex items-center space-evenly space-x-1 md:justify-center w-full h-10\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\t:id=\"a.nom\"\r\n\t\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\t\t'focus:outline-none focus:ring-0 rounded-md w-5 h-5',\r\n\t\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t\t\t:checked=\"\r\n\t\t\t\t\t\t\t\t\t\tselectedFonction &&\r\n\t\t\t\t\t\t\t\t\t\tselectedFonction.Autorisations.map((el) => el.id).includes(\r\n\t\t\t\t\t\t\t\t\t\t\ta.id\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t@change=\"updateAutorisation(a, 'all')\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<label :for=\"a.nom\" class=\"md:hidden\">{{\r\n\t\t\t\t\t\t\t\t\ta.description\r\n\t\t\t\t\t\t\t\t}}</label>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\"inline-flex md:grid md:grid-row-2 items-center space-evenly md:justify-center ml-5 md:ml-0\"\r\n\t\t\t\t\t\t\t\tv-if=\"\r\n\t\t\t\t\t\t\t\t\tselectedFonction &&\r\n\t\t\t\t\t\t\t\t\tselectedFonction.Autorisations.find((el) => el.id == a.id) &&\r\n\t\t\t\t\t\t\t\t\t!a.nom.startsWith('add') &&\r\n\t\t\t\t\t\t\t\t\tselectedFonction.Autorisations.find((el) => el.id === a.id)\r\n\t\t\t\t\t\t\t\t\t\t.autorisations_fonctions\r\n\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<!-- <div\r\n\t\t\t\t\t\t\t\t\tclass=\"inline-flex space-x-1 w-full justify-center items-center\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\t\t\t\t\t\t:id=\"a.nom + '-own'\"\r\n\t\t\t\t\t\t\t\t\t\t:name=\"a.nom\"\r\n\t\t\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\t\t\t'focus:outline-none focus:ring-0 rounded-md w-3 h-3',\r\n\t\t\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t\t\t\tvalue=\"own\"\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"\r\n\t\t\t\t\t\t\t\t\t\t\tselectedFonction.Autorisations.find(\r\n\t\t\t\t\t\t\t\t\t\t\t\t(el) => el.id === a.id\r\n\t\t\t\t\t\t\t\t\t\t\t).autorisations_fonctions.type\r\n\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t@change=\"selectedFonction.updated = false\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<label :for=\"a.nom + '-own'\">Own Only</label>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclass=\"inline-flex space-x-1 w-full justify-center items-center\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"\r\n\t\t\t\t\t\t\t\t\t\t\tselectedFonction.Autorisations.find(\r\n\t\t\t\t\t\t\t\t\t\t\t\t(el) => el.id === a.id\r\n\t\t\t\t\t\t\t\t\t\t\t).autorisations_fonctions.type\r\n\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t@change=\"selectedFonction.updated = false\"\r\n\t\t\t\t\t\t\t\t\t\t:id=\"a.nom + '-all'\"\r\n\t\t\t\t\t\t\t\t\t\t:name=\"a.nom\"\r\n\t\t\t\t\t\t\t\t\t\t:class=\"[\r\n\t\t\t\t\t\t\t\t\t\t\t'focus:outline-none focus:ring-0 rounded-md w-3 h-3',\r\n\t\t\t\t\t\t\t\t\t\t]\"\r\n\t\t\t\t\t\t\t\t\t\tvalue=\"all\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<label :for=\"a.nom + '-all'\">All</label>\r\n\t\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!-- gestion des utilisateurs\r\n\t\t\tgestion des roles\r\n\t\t\tgestion des commandes\r\n\t\t\tgestion des clients\r\n\t\t\tgestion des payement\r\n\t\t\tgestion des produits\r\n\t\t\tgestion de la matiere premiere -->\r\n\t\t</div>\r\n\t\t<div class=\"h-16 inline-flex items-center justify-end space-x-1 pb-2 pr-2\">\r\n\t\t\t<button\r\n\t\t\t\t@click=\"deleteFonction\"\r\n\t\t\t\t:class=\"[\r\n\t\t\t\t\t'bg-red-500 text-white text-sm sm:text-base font-semibold rounded-md py-1.5 px-1 focus:outline-none focus:ring-2 focus:ring-red-500 md:hidden',\r\n\t\t\t\t]\"\r\n\t\t\t>\r\n\t\t\t\tArchiver le Profile\r\n\t\t\t</button>\r\n\t\t\t<button\r\n\t\t\t\t@click=\"updateFonction\"\r\n\t\t\t\t:class=\"[\r\n\t\t\t\t\t'bg-green-500 text-white font-semibold rounded-md py-1 px-2 focus:outline-none focus:ring-2 focus:ring-green-500',\r\n\t\t\t\t\tselectedFonction?.updated && 'bg-opacity-50',\r\n\t\t\t\t]\"\r\n\t\t\t\t:disable=\"!selectedFonction?.updated || false\"\r\n\t\t\t>\r\n\t\t\t\tEnregistrer\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>\r\n\t<Modal ref=\"createModal\" primaryColor=\"haja\" @submit=\"saveFonction\">\r\n\t\t<template v-slot:title>\r\n\t\t\t<div class=\"inline-flex items-center\">\r\n\t\t\t\t<Icon icon=\"carbon:bookmark-add\" class=\"w-5 h-5 mr-2\" /> Ajouter une\r\n\t\t\t\tfonction\r\n\t\t\t</div>\r\n\t\t</template>\r\n\t\t<template v-slot:body>\r\n\t\t\t<div class=\"flex flex-col w-full space-y-2\">\r\n\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\tclass=\"block text-gray-700 text-sm font-semibold mb-2\"\r\n\t\t\t\t\t\tfor=\"nom\"\r\n\t\t\t\t\t\t>Nom</label\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"nom\"\r\n\t\t\t\t\t\tv-model=\"newFonction.nom\"\r\n\t\t\t\t\t\tclass=\"rounded-md w-full\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t<label for=\"color\">Choisissez une couleur: </label>\r\n\t\t\t\t\t<div class=\"w-full inline-flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\"rounded-md w-20\"\r\n\t\t\t\t\t\t\ttype=\"color\"\r\n\t\t\t\t\t\t\tname=\"color\"\r\n\t\t\t\t\t\t\tv-model=\"newFonction.couleur\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tv-model=\"newFonction.couleur\"\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tclass=\"rounded-md border-none text-gray-400 w-24\"\r\n\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"w-full flex flex-col\">\r\n\t\t\t\t\t<label for=\"icon\">Choisissez une icon :</label>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tv-model=\"newFonction.icon\"\r\n\t\t\t\t\t\tclass=\"rounded-md text-gray-400 w-full\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tv-if=\"icons.length != 0\"\r\n\t\t\t\t\t\tclass=\"grid grid-cols-6 border-1 border-blue-900 h-36 overflow-y-auto mt-2\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tv-for=\"icon in icons\"\r\n\t\t\t\t\t\t\t:icon=\"icon\"\r\n\t\t\t\t\t\t\t:key=\"icon\"\r\n\t\t\t\t\t\t\t@click=\"newFonction.icon = icon\"\r\n\t\t\t\t\t\t\tclass=\"w-12 h-12 p-0.5 rounded-md m-1 focus:border-indigo-900 focus:border hover:bg-gray-400\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\tclass=\"block text-gray-700 text-sm font-semibold mb-2\"\r\n\t\t\t\t\t\tfor=\"description\"\r\n\t\t\t\t\t\t>Description</label\r\n\t\t\t\t\t>\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tv-model=\"newFonction.description\"\r\n\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\tclass=\"resize-x-none rounded-md w-full\"\r\n\t\t\t\t\t></textarea>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</template>\r\n\t\t<template v-slot:submit>Ajouter</template>\r\n\t</Modal>\r\n</template>\r\n\r\n<script>\r\nimport Modal from \"@/components/Modal\";\r\nimport { CheckIcon, SelectorIcon } from \"@heroicons/vue/solid\";\r\nimport {\r\n\tListbox,\r\n\tListboxButton,\r\n\tListboxOptions,\r\n\tListboxOption,\r\n} from \"@headlessui/vue\";\r\nimport { Icon } from \"@iconify/vue\";\r\nimport axios from \"axios\";\r\nimport _ from \"lodash\";\r\nexport default {\r\n\tname: \"Fonctions\",\r\n\tcomponents: {\r\n\t\tModal,\r\n\t\tListbox,\r\n\t\tListboxButton,\r\n\t\tListboxOptions,\r\n\t\tListboxOption,\r\n\t\tCheckIcon,\r\n\t\tSelectorIcon,\r\n\t\tIcon,\r\n\t},\r\n\tmethods: {\r\n\t\tcapitalize(str) {\r\n\t\t\treturn str.charAt(0).toUpperCase() + str.slice(1);\r\n\t\t},\r\n\t\topenCreateModal() {\r\n\t\t\tthis.$refs.createModal.open = true;\r\n\t\t},\r\n\t\topendeletemodal(fonction) {\r\n\t\t\tthis.$refs.obj = fonction;\r\n\t\t\tthis.$refs.deletedModal.open = true;\r\n\t\t},\r\n\t\t// eslint-disable-next-line no-unused-vars\r\n\t\tupdateAutorisation(aut, type) {\r\n\t\t\tif (this.selectedFonction.Autorisations.find((el) => el.id === aut.id)) {\r\n\t\t\t\tthis.selectedFonction.Autorisations =\r\n\t\t\t\t\tthis.selectedFonction.Autorisations.filter(\r\n\t\t\t\t\t\t(autorisation) => autorisation.id != aut.id\r\n\t\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t// aut.autorisations_fonctions?.type = type || 'all';\r\n\r\n\t\t\t\tthis.selectedFonction.Autorisations.push({\r\n\t\t\t\t\tautorisations_fonctions: { type: type || \"all\" },\r\n\t\t\t\t\t...aut,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.selectedFonction.updated = false;\r\n\t\t},\r\n\t\tasync updateFonction() {\r\n\t\t\tif (this.selectedFonction.updated) return;\r\n\t\t\ttry {\r\n\t\t\t\tthis.$store\r\n\t\t\t\t\t.dispatch(\"updateFonction\", this.selectedFonction)\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tthis.selectedFonction.updated = true;\r\n\t\t\t\t\t});\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync saveFonction() {\r\n\t\t\ttry {\r\n\t\t\t\tawait this.$store.dispatch(\"addFonction\", this.newFonction);\r\n\t\t\t\tthis.$refs.createModal.open = false;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync deleteFonction(f) {\r\n\t\t\tconsole.log(f)\r\n\t\t\ttry {\r\n\t\t\t\tawait this.$store.dispatch(\r\n\t\t\t\t\t\"deleteFonction\",\r\n\t\t\t\t\tf.id || this.selectedFonction.id\r\n\t\t\t\t);\r\n\t\t\t\t// this.$refs.deletedModal.open = false;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tchangedColor(color) {\r\n\t\t\tthis.newFonction.couleur = color;\r\n\t\t},\r\n\t},\r\n\tasync beforeMount() {\r\n\t\tawait this.$store.dispatch(\"getFonctions\");\r\n\t\tawait this.$store.dispatch(\"getAutorisations\");\r\n\t\t// console.log(\"hey\",)\r\n\t\tthis.selectedFonction =\r\n\t\t\tthis.fonctions[\r\n\t\t\t\tthis.fonctions\r\n\t\t\t\t\t.map((el) => el.id)\r\n\t\t\t\t\t.indexOf(this.$store.state.users.user.Profile.id)\r\n\t\t\t];\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tselectedFonction: null,\r\n\t\t\tnewFonction: {},\r\n\t\t\tdeletedFonction: {},\r\n\t\t\ticons: [],\r\n\t\t\tisMobile: false,\r\n\t\t\tshowColorPicker: false,\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\tautorisations() {\r\n\t\t\treturn this.$store.state.fonctions.autorisations;\r\n\t\t},\r\n\t\tcategories() {\r\n\t\t\treturn this.$store.state.fonctions.autorisations\r\n\t\t\t\t.map((autorisation) => autorisation.categorie)\r\n\t\t\t\t.filter((categorie, index, self) => self.indexOf(categorie) === index);\r\n\t\t},\r\n\t\tfonctions() {\r\n\t\t\treturn this.$store.state.fonctions.fonctions;\r\n\t\t},\r\n\t},\r\n\twatch: {\r\n\t\t\"newFonction.icon\": _.debounce(async function () {\r\n\t\t\tthis.icons = (\r\n\t\t\t\tawait axios.get(\r\n\t\t\t\t\t`https://api.iconify.design/search?query=${this.newFonction.icon}`\r\n\t\t\t\t)\r\n\t\t\t).data.icons;\r\n\t\t}, 200),\r\n\t\tselectedFonction() {\r\n\t\t\t// this.$store.dispatch('getFonctions')\r\n\r\n\t\t\tif (this.selectedFonction.updated === undefined)\r\n\t\t\t\tthis.selectedFonction.updated = true;\r\n\t\t},\r\n\t\t\"fonctions\":function(){\r\n\t\t\tif(!this.fonctions.find(el=>el.id == this.selectedFonction)){\r\n\t\t\t\tthis.selectedFonction = this.fonctions.find(el=>el.id == this.$store.state.users.user.Profile.id)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.diamond {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\ttext-align: center;\r\n\ttransform: rotate(45deg);\r\n}\r\n.diamond > div {\r\n\ttransform: rotate(-45deg);\r\n}\r\n</style>\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}